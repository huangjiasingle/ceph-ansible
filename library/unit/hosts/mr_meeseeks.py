ansible_devices = {
    "dm-0": {
        "holders": [],
        "host": "",
                "links": {
                    "ids": [
                        "dm-name-ceph--a4a33288--6aa9--443d--a1aa--aa0fa655a057-osd--block--5cfacdf7--999e--4b1d--b599--515b2a02faa9",  # noqa E501
                        "dm-uuid-LVM-fcAebeHCpaE8mcXJxxMOgsFE8qtqw7m2FdQUPIxvp21tAcubIODGAfyfATFAO24e"  # noqa E501
                    ],
                    "labels": [],
                    "masters": [],
                    "uuids": []
        },
        "model": "",
        "partitions": {},
        "removable": "0",
        "rotational": "1",
        "sas_address": "",
        "sas_device_handle": "",
        "scheduler_mode": "",
        "sectors": "585867264",
        "sectorsize": "512",
        "size": "279.36 GB",
                "support_discard": "0",
                "vendor": "",
                "virtual": 1
    },
    "loop0": {
        "holders": [],
        "host": "",
                "links": {
                    "ids": [],
                    "labels": [],
                    "masters": [],
                    "uuids": []
        },
        "model": "",
        "partitions": {},
        "removable": "0",
        "rotational": "1",
        "sas_address": "",
        "sas_device_handle": "",
        "scheduler_mode": "",
        "sectors": "20971520",
        "sectorsize": "512",
        "size": "10.00 GB",
                "support_discard": "4096",
                "vendor": "",
                "virtual": 1
    },
    "sda": {
        "holders": [],
        "host": "RAID bus controller: Hewlett-Packard Company Smart Array Gen8 Controllers (rev 01)",  # noqa E501
                "links": {
                    "ids": [
                        "scsi-3600508b1001ca3a81462043ff6d56249",
                        "wwn-0x600508b1001ca3a81462043ff6d56249"
                    ],
                    "labels": [],
                    "masters": [],
                    "uuids": []
        },
        "model": "LOGICAL VOLUME",
        "partitions": {
                    "sda1": {
                        "holders": [],
                        "links": {
                            "ids": [
                                "scsi-3600508b1001ca3a81462043ff6d56249-part1",
                                "wwn-0x600508b1001ca3a81462043ff6d56249-part1"
                            ],
                            "labels": [],
                            "masters": [],
                            "uuids": []
                        },
                        "sectors": "4096",
                        "sectorsize": 512,
                        "size": "2.00 MB",
                        "start": "2048",
                        "uuid": ""
                    },
                    "sda2": {
                        "holders": [],
                        "links": {
                            "ids": [
                                "scsi-3600508b1001ca3a81462043ff6d56249-part2",
                                "wwn-0x600508b1001ca3a81462043ff6d56249-part2"
                            ],
                            "labels": [],
                            "masters": [],
                            "uuids": [
                                "3ca77e89-f2b5-40b2-940d-71a18bf6b4bf"
                            ]
                        },
                        "sectors": "2097152",
                        "sectorsize": 512,
                        "size": "1.00 GB",
                        "start": "6144",
                        "uuid": "3ca77e89-f2b5-40b2-940d-71a18bf6b4bf"
                    },
                    "sda3": {
                        "holders": [],
                        "links": {
                            "ids": [
                                "scsi-3600508b1001ca3a81462043ff6d56249-part3",
                                "wwn-0x600508b1001ca3a81462043ff6d56249-part3"
                            ],
                            "labels": [],
                            "masters": [],
                            "uuids": [
                                "777e7fae-6c9e-4a11-aaf9-2614bb4a1589"
                            ]
                        },
                        "sectors": "8388608",
                        "sectorsize": 512,
                        "size": "4.00 GB",
                        "start": "2103296",
                        "uuid": "777e7fae-6c9e-4a11-aaf9-2614bb4a1589"
                    },
                    "sda4": {
                        "holders": [],
                        "links": {
                            "ids": [
                                "scsi-3600508b1001ca3a81462043ff6d56249-part4",
                                "wwn-0x600508b1001ca3a81462043ff6d56249-part4"
                            ],
                            "labels": [],
                            "masters": [],
                            "uuids": []
                        },
                        "sectors": "2",
                        "sectorsize": 512,
                        "size": "1.00 KB",
                        "start": "10491904",
                        "uuid": ""
                    },
                    "sda5": {
                        "holders": [],
                        "links": {
                            "ids": [
                                "scsi-3600508b1001ca3a81462043ff6d56249-part5",
                                "wwn-0x600508b1001ca3a81462043ff6d56249-part5"
                            ],
                            "labels": [],
                            "masters": [],
                            "uuids": [
                                "e4c40980-8888-4a85-b79e-03b22222fe11"
                            ]
                        },
                        "sectors": "2332993536",
                        "sectorsize": 512,
                        "size": "1.09 TB",
                        "start": "10493952",
                        "uuid": "e4c40980-8888-4a85-b79e-03b22222fe11"
                    }
        },
        "removable": "0",
        "rotational": "1",
        "sas_address": "",
        "sas_device_handle": "",
        "scheduler_mode": "deadline",
        "sectors": "2343487580",
        "sectorsize": "512",
        "size": "1.09 TB",
                "support_discard": "0",
                "vendor": "HP",
                "virtual": 1,
                "wwn": "0x600508b1001ca3a81462043ff6d56249"
    },
    "sdb": {
        "holders": [],
        "host": "RAID bus controller: Hewlett-Packard Company Smart Array Gen8 Controllers (rev 01)",  # noqa E501
                "links": {
                    "ids": [
                        "scsi-3600508b1001cfd8a26ebab00165730db",
                        "wwn-0x600508b1001cfd8a26ebab00165730db"
                    ],
                    "labels": [],
                    "masters": [],
                    "uuids": []
        },
        "model": "LOGICAL VOLUME",
        "partitions": {
                    "sdb1": {
                        "holders": [],
                        "links": {
                            "ids": [
                                "scsi-3600508b1001cfd8a26ebab00165730db-part1",
                                "wwn-0x600508b1001cfd8a26ebab00165730db-part1"
                            ],
                            "labels": [],
                            "masters": [],
                            "uuids": []
                        },
                        "sectors": "10485760",
                        "sectorsize": 512,
                        "size": "5.00 GB",
                        "start": "2048",
                        "uuid": ""
                    },
                    "sdb2": {
                        "holders": [],
                        "links": {
                            "ids": [
                                "scsi-3600508b1001cfd8a26ebab00165730db-part2",
                                "wwn-0x600508b1001cfd8a26ebab00165730db-part2"
                            ],
                            "labels": [],
                            "masters": [],
                            "uuids": []
                        },
                        "sectors": "10485760",
                        "sectorsize": 512,
                        "size": "5.00 GB",
                        "start": "10487808",
                        "uuid": ""
                    },
                    "sdb3": {
                        "holders": [],
                        "links": {
                            "ids": [
                                "scsi-3600508b1001cfd8a26ebab00165730db-part3",
                                "wwn-0x600508b1001cfd8a26ebab00165730db-part3"
                            ],
                            "labels": [],
                            "masters": [],
                            "uuids": []
                        },
                        "sectors": "10485760",
                        "sectorsize": 512,
                        "size": "5.00 GB",
                        "start": "20973568",
                        "uuid": ""
                    },
                    "sdb4": {
                        "holders": [],
                        "links": {
                            "ids": [
                                "scsi-3600508b1001cfd8a26ebab00165730db-part4",
                                "wwn-0x600508b1001cfd8a26ebab00165730db-part4"
                            ],
                            "labels": [],
                            "masters": [],
                            "uuids": []
                        },
                        "sectors": "10485760",
                        "sectorsize": 512,
                        "size": "5.00 GB",
                        "start": "31459328",
                        "uuid": ""
                    },
                    "sdb5": {
                        "holders": [],
                        "links": {
                            "ids": [
                                "scsi-3600508b1001cfd8a26ebab00165730db-part5",
                                "wwn-0x600508b1001cfd8a26ebab00165730db-part5"
                            ],
                            "labels": [],
                            "masters": [],
                            "uuids": []
                        },
                        "sectors": "2097152",
                        "sectorsize": 512,
                        "size": "1.00 GB",
                        "start": "41945088",
                        "uuid": ""
                    },
                    "sdb6": {
                        "holders": [],
                        "links": {
                            "ids": [
                                "scsi-3600508b1001cfd8a26ebab00165730db-part6",
                                "wwn-0x600508b1001cfd8a26ebab00165730db-part6"
                            ],
                            "labels": [],
                            "masters": [],
                            "uuids": []
                        },
                        "sectors": "1179648",
                        "sectorsize": 512,
                        "size": "576.00 MB",
                        "start": "44042240",
                        "uuid": ""
                    }
        },
        "removable": "0",
        "rotational": "0",
        "sas_address": "",
        "sas_device_handle": "",
        "scheduler_mode": "deadline",
        "sectors": "195301440",
        "sectorsize": "512",
        "size": "93.13 GB",
                "support_discard": "0",
                "vendor": "HP",
                "virtual": 1,
                "wwn": "0x600508b1001cfd8a26ebab00165730db"
    },
    "sdc": {
        "holders": [],
        "host": "RAID bus controller: Hewlett-Packard Company Smart Array Gen8 Controllers (rev 01)",  # noqa E501
                "links": {
                    "ids": [
                        "scsi-3600508b1001cac46e2123a4f9b990f4a",
                        "wwn-0x600508b1001cac46e2123a4f9b990f4a"
                    ],
                    "labels": [],
                    "masters": [],
                    "uuids": []
        },
        "model": "LOGICAL VOLUME",
        "partitions": {},
        "removable": "0",
        "rotational": "0",
        "sas_address": "",
        "sas_device_handle": "",
        "scheduler_mode": "deadline",
        "sectors": "195301440",
        "sectorsize": "512",
        "size": "93.13 GB",
                "support_discard": "0",
                "vendor": "HP",
                "virtual": 1,
                "wwn": "0x600508b1001cac46e2123a4f9b990f4a"
    },
    "sdd": {
        "holders": [],
        "host": "RAID bus controller: Hewlett-Packard Company Smart Array Gen8 Controllers (rev 01)",  # noqa E501
                "links": {
                    "ids": [
                        "scsi-3600508b1001c89c66f6f430078ce2885",
                        "wwn-0x600508b1001c89c66f6f430078ce2885"
                    ],
                    "labels": [],
                    "masters": [],
                    "uuids": []
        },
        "model": "LOGICAL VOLUME",
        "partitions": {
                    "sdd1": {
                        "holders": [],
                        "links": {
                            "ids": [
                                "scsi-3600508b1001c89c66f6f430078ce2885-part1",
                                "wwn-0x600508b1001c89c66f6f430078ce2885-part1"
                            ],
                            "labels": [],
                            "masters": [],
                            "uuids": [
                                "a460056e-a304-4450-abe6-2e7beb4cb091"
                            ]
                        },
                        "sectors": "204800",
                        "sectorsize": 512,
                        "size": "100.00 MB",
                        "start": "2048",
                        "uuid": "a460056e-a304-4450-abe6-2e7beb4cb091"
                    },
                    "sdd2": {
                        "holders": [],
                        "links": {
                            "ids": [
                                "scsi-3600508b1001c89c66f6f430078ce2885-part2",
                                "wwn-0x600508b1001c89c66f6f430078ce2885-part2"
                            ],
                            "labels": [],
                            "masters": [],
                            "uuids": []
                        },
                        "sectors": "585665083",
                        "sectorsize": 512,
                        "size": "279.27 GB",
                        "start": "206848",
                        "uuid": ""
                    }
        },
        "removable": "0",
        "rotational": "1",
        "sas_address": "",
        "sas_device_handle": "",
        "scheduler_mode": "deadline",
        "sectors": "585871964",
        "sectorsize": "512",
        "size": "279.37 GB",
                "support_discard": "0",
                "vendor": "HP",
                "virtual": 1,
                "wwn": "0x600508b1001c89c66f6f430078ce2885"
    },
    "sde": {
        "holders": [
            "ceph--a4a33288--6aa9--443d--a1aa--aa0fa655a057-osd--block--5cfacdf7--999e--4b1d--b599--515b2a02faa9"  # noqa E501
        ],
        "host": "RAID bus controller: Hewlett-Packard Company Smart Array Gen8 Controllers (rev 01)",  # noqa E501
                "links": {
                    "ids": [
                        "lvm-pv-uuid-m693Js-aFH4-twLI-0ALf-4sWa-EwfM-k6K6Vk",
                        "scsi-3600508b1001c00636d7445ee0288f0e6",
                        "wwn-0x600508b1001c00636d7445ee0288f0e6"
                    ],
                    "labels": [],
                    "masters": [
                        "dm-0"
                    ],
                    "uuids": []
        },
        "model": "LOGICAL VOLUME",
        "partitions": {},
        "removable": "0",
        "rotational": "1",
        "sas_address": "",
        "sas_device_handle": "",
        "scheduler_mode": "deadline",
        "sectors": "585871964",
        "sectorsize": "512",
        "size": "279.37 GB",
                "support_discard": "0",
                "vendor": "HP",
                "virtual": 1,
                "wwn": "0x600508b1001c00636d7445ee0288f0e6"
    },
    "sdf": {
        "holders": [],
        "host": "USB controller: Intel Corporation C600/X79 series chipset USB2 Enhanced Host Controller #1 (rev 05)",  # noqa E501
                "links": {
                    "ids": [
                        "usb-HP_iLO_LUN_00_Media_0_000002660A01-0:0"
                    ],
                    "labels": [],
                    "masters": [],
                    "uuids": []
        },
        "model": "LUN 00 Media 0",
        "partitions": {
                    "sdf1": {
                        "holders": [],
                        "links": {
                            "ids": [
                                "usb-HP_iLO_LUN_00_Media_0_000002660A01-0:0-part1"
                            ],
                            "labels": [
                                "VID"
                            ],
                            "masters": [],
                            "uuids": [
                                "5201-7CA7"
                            ]
                        },
                        "sectors": "514017",
                        "sectorsize": 512,
                        "size": "250.98 MB",
                        "start": "63",
                        "uuid": "5201-7CA7"
                    }
        },
        "removable": "0",
        "rotational": "1",
        "sas_address": "",
        "sas_device_handle": "",
        "scheduler_mode": "deadline",
        "sectors": "524288",
        "sectorsize": "512",
        "size": "256.00 MB",
                "support_discard": "0",
                "vendor": "HP iLO",
                "virtual": 1
    }
}


def prepare_test_find_match_matched():
    disk_0 = {'storage_disks': {'ceph_type': 'block', 'rotational': '0',
                                'vendor': 'HP', 'size': {'and': [{'gt': '80 GB'}, {'lt': '100 GB'}]}}}  # noqa E501
    expected_result = {
        'storage_disks': {'ceph_type': 'block',
                          'holders': [],
                          'host': 'RAID bus controller: Hewlett-Packard Company Smart Array Gen8 Controllers (rev 01)',  # noqa E501
                          'links': {'ids': ['scsi-3600508b1001cfd8a26ebab00165730db',
                                            'wwn-0x600508b1001cfd8a26ebab00165730db'],
                                    'labels': [],
                                    'masters': [],
                                    'uuids': []},
                          'model': 'LOGICAL VOLUME',
                          'partitions': {'sdb1': {'holders': [],
                                                  'links': {'ids': ['scsi-3600508b1001cfd8a26ebab00165730db-part1',  # noqa E501
                                                                    'wwn-0x600508b1001cfd8a26ebab00165730db-part1'],  # noqa E501
                                                            'labels': [],
                                                            'masters': [],
                                                            'uuids': []},
                                                  'sectors': '10485760',
                                                  'sectorsize': 512,
                                                  'size': '5.00 GB',
                                                  'start': '2048',
                                                  'uuid': ''},
                                         'sdb2': {'holders': [],
                                                  'links': {'ids': ['scsi-3600508b1001cfd8a26ebab00165730db-part2',  # noqa E501
                                                                    'wwn-0x600508b1001cfd8a26ebab00165730db-part2'],  # noqa E501
                                                            'labels': [],
                                                            'masters': [],
                                                            'uuids': []},
                                                  'sectors': '10485760',
                                                  'sectorsize': 512,
                                                  'size': '5.00 GB',
                                                  'start': '10487808',
                                                  'uuid': ''},
                                         'sdb3': {'holders': [],
                                                  'links': {'ids': ['scsi-3600508b1001cfd8a26ebab00165730db-part3',  # noqa E501
                                                                    'wwn-0x600508b1001cfd8a26ebab00165730db-part3'],  # noqa E501
                                                            'labels': [],
                                                            'masters': [],
                                                            'uuids': []},
                                                  'sectors': '10485760',
                                                  'sectorsize': 512,
                                                  'size': '5.00 GB',
                                                  'start': '20973568',
                                                  'uuid': ''},
                                         'sdb4': {'holders': [],
                                                  'links': {'ids': ['scsi-3600508b1001cfd8a26ebab00165730db-part4',  # noqa E501
                                                                    'wwn-0x600508b1001cfd8a26ebab00165730db-part4'],  # noqa E501
                                                            'labels': [],
                                                            'masters': [],
                                                            'uuids': []},
                                                  'sectors': '10485760',
                                                  'sectorsize': 512,
                                                  'size': '5.00 GB',
                                                  'start': '31459328',
                                                  'uuid': ''},
                                         'sdb5': {'holders': [],
                                                  'links': {'ids': ['scsi-3600508b1001cfd8a26ebab00165730db-part5',  # noqa E501
                                                                    'wwn-0x600508b1001cfd8a26ebab00165730db-part5'],  # noqa E501
                                                            'labels': [],
                                                            'masters': [],
                                                            'uuids': []},
                                                  'sectors': '2097152',
                                                  'sectorsize': 512,
                                                  'size': '1.00 GB',
                                                  'start': '41945088',
                                                  'uuid': ''},
                                         'sdb6': {'holders': [],
                                                  'links': {'ids': ['scsi-3600508b1001cfd8a26ebab00165730db-part6',  # noqa E501
                                                                    'wwn-0x600508b1001cfd8a26ebab00165730db-part6'],  # noqa E501
                                                            'labels': [],
                                                            'masters': [],
                                                            'uuids': []},
                                                  'sectors': '1179648',
                                                  'sectorsize': 512,
                                                  'size': '576.00 MB',
                                                  'start': '44042240',
                                                  'uuid': ''}},
                          'removable': '0',
                          'rotational': '0',
                          'sas_address': '',
                          'sas_device_handle': '',
                          'scheduler_mode': 'deadline',
                          'sectors': '195301440',
                          'sectorsize': '512',
                          'size': '93.13 GB',
                          'support_discard': '0',
                          'vendor': 'HP',
                          'virtual': 1,
                          'wwn': '0x600508b1001cfd8a26ebab00165730db'}

    }

    return (disk_0, expected_result)


def prepare_test_find_match_unmatched():
    return ({'storage_disks': {'count': '*', 'ceph_type': 'block', 'rotational': '0', 'vendor': 'HP', 'size': {'and': [{'gt': '80 GB'}, {'lt': '100 GB'}]}}}, {})  # noqa E501


def prepare_test_select_only_free_devices():
    return {'sdb1': {'bdev': '/dev/sdb1',
                     'ceph_prepared': 'ceph journal',
                     'holders': [],
                     'links': {'ids': ['scsi-3600508b1001cfd8a26ebab00165730db-part1',
                                       'wwn-0x600508b1001cfd8a26ebab00165730db-part1'],
                               'labels': [],
                               'masters': [],
                               'uuids': []},
                     'model': 'LOGICAL VOLUME',
                     'rotational': '0',
                     'sectors': '10485760',
                     'sectorsize': 512,
                     'size': '5.00 GB',
                     'start': '2048',
                     'uuid': '',
                     'vendor': 'HP'},
            'sdb2': {'bdev': '/dev/sdb2',
                     'ceph_prepared': 'ceph journal',
                     'holders': [],
                     'links': {'ids': ['scsi-3600508b1001cfd8a26ebab00165730db-part2',
                                       'wwn-0x600508b1001cfd8a26ebab00165730db-part2'],
                               'labels': [],
                               'masters': [],
                               'uuids': []},
                     'model': 'LOGICAL VOLUME',
                     'rotational': '0',
                     'sectors': '10485760',
                     'sectorsize': 512,
                     'size': '5.00 GB',
                     'start': '10487808',
                     'uuid': '',
                     'vendor': 'HP'},
            'sdb3': {'bdev': '/dev/sdb3',
                     'ceph_prepared': 'ceph journal',
                     'holders': [],
                     'links': {'ids': ['scsi-3600508b1001cfd8a26ebab00165730db-part3',
                                       'wwn-0x600508b1001cfd8a26ebab00165730db-part3'],
                               'labels': [],
                               'masters': [],
                               'uuids': []},
                     'model': 'LOGICAL VOLUME',
                     'rotational': '0',
                     'sectors': '10485760',
                     'sectorsize': 512,
                     'size': '5.00 GB',
                     'start': '20973568',
                     'uuid': '',
                     'vendor': 'HP'},
            'sdb4': {'bdev': '/dev/sdb4',
                     'ceph_prepared': 'ceph journal',
                     'holders': [],
                     'links': {'ids': ['scsi-3600508b1001cfd8a26ebab00165730db-part4',
                                       'wwn-0x600508b1001cfd8a26ebab00165730db-part4'],
                               'labels': [],
                               'masters': [],
                               'uuids': []},
                     'model': 'LOGICAL VOLUME',
                     'rotational': '0',
                     'sectors': '10485760',
                     'sectorsize': 512,
                     'size': '5.00 GB',
                     'start': '31459328',
                     'uuid': '',
                     'vendor': 'HP'},
            'sdb5': {'bdev': '/dev/sdb5',
                     'ceph_prepared': 'ceph block.db',
                     'holders': [],
                     'links': {'ids': ['scsi-3600508b1001cfd8a26ebab00165730db-part5',
                                       'wwn-0x600508b1001cfd8a26ebab00165730db-part5'],
                               'labels': [],
                               'masters': [],
                               'uuids': []},
                     'model': 'LOGICAL VOLUME',
                     'rotational': '0',
                     'sectors': '2097152',
                     'sectorsize': 512,
                     'size': '1.00 GB',
                     'start': '41945088',
                     'uuid': '',
                     'vendor': 'HP'},
            'sdb6': {'bdev': '/dev/sdb6',
                     'ceph_prepared': 'ceph block.wal',
                     'holders': [],
                     'links': {'ids': ['scsi-3600508b1001cfd8a26ebab00165730db-part6',
                                       'wwn-0x600508b1001cfd8a26ebab00165730db-part6'],
                               'labels': [],
                               'masters': [],
                               'uuids': []},
                     'model': 'LOGICAL VOLUME',
                     'rotational': '0',
                     'sectors': '1179648',
                     'sectorsize': 512,
                     'size': '576.00 MB',
                     'start': '44042240',
                     'uuid': '',
                     'vendor': 'HP'},
            'sdc': {'bdev': '/dev/sdc',
                    'holders': [],
                    'host': 'RAID bus controller: Hewlett-Packard Company Smart Array Gen8 Controllers (rev 01)',  # noqa E501
                    'links': {'ids': ['scsi-3600508b1001cac46e2123a4f9b990f4a',
                                      'wwn-0x600508b1001cac46e2123a4f9b990f4a'],
                              'labels': [],
                              'masters': [],
                              'uuids': []},
                    'model': 'LOGICAL VOLUME',
                    'partitions': {},
                    'removable': '0',
                                 'rotational': '0',
                                 'sas_address': '',
                                 'sas_device_handle': '',
                                 'scheduler_mode': 'deadline',
                                 'sectors': '195301440',
                                 'sectorsize': '512',
                                 'size': '93.13 GB',
                                 'support_discard': '0',
                                 'vendor': 'HP',
                                 'virtual': 1,
                                 'wwn': '0x600508b1001cac46e2123a4f9b990f4a'},
            'sdd2': {'bdev': '/dev/sdd2',
                     'ceph_prepared': 'ceph block',
                     'holders': [],
                     'links': {'ids': ['scsi-3600508b1001c89c66f6f430078ce2885-part2',
                                       'wwn-0x600508b1001c89c66f6f430078ce2885-part2'],
                               'labels': [],
                               'masters': [],
                               'uuids': []},
                     'model': 'LOGICAL VOLUME',
                     'rotational': '1',
                     'sectors': '585665083',
                     'sectorsize': 512,
                     'size': '279.27 GB',
                     'start': '206848',
                     'uuid': '',
                     'vendor': 'HP'}}


fake_fsid = "97e40ff4-97d7-4dc6-8bf5-bad598480621"


def read_ceph_disk(container_image=None):
    return [{"path": "/dev/dm-0", "type": "other", "dmcrypt": {}, "ptype": "unknown", "is_partition": False}, {"path": "/dev/loop0", "type": "other", "dmcrypt": {}, "ptype": "unknown", "is_partition": False}, {"path": "/dev/sda", "partitions": [{"dmcrypt": {}, "uuid": "", "ptype": "0x83", "is_partition": True, "path": "/dev/sda1", "type": "other"}, {"dmcrypt": {}, "uuid": "", "mount": "/boot", "ptype": "0x83", "is_partition": True, "fs_type": "xfs", "path": "/dev/sda2", "type": "other"}, {"dmcrypt": {}, "uuid": "", "ptype": "0x82", "is_partition": True, "fs_type": "swap", "path": "/dev/sda3", "type": "swap"}, {"dmcrypt": {}, "uuid": "", "ptype": "0x5", "is_partition": True, "path": "/dev/sda4", "type": "other"}, {"dmcrypt": {}, "uuid": "", "mount": "/", "ptype": "0x83", "is_partition": True, "fs_type": "xfs", "path": "/dev/sda5", "type": "other"}]}, {"path": "/dev/sdb", "partitions": [{"dmcrypt": {}, "uuid": "bef582a7-e73a-41a6-8593-fb83fa5c9655", "ptype": "45b0969e-9b03-4f30-b4c6-b4b80ceff106", "is_partition": True, "path": "/dev/sdb1", "type": "journal"}, {"dmcrypt": {}, "uuid": "0be8599f-6d16-4e6c-9013-d0b9bff664e3", "ptype": "45b0969e-9b03-4f30-b4c6-b4b80ceff106", "is_partition": True, "path": "/dev/sdb2", "type": "journal"}, {"dmcrypt": {}, "uuid": "fdc47808-de22-45b8-9884-30564042976d", "ptype": "45b0969e-9b03-4f30-b4c6-b4b80ceff106", "is_partition": True, "path": "/dev/sdb3", "type": "journal"}, {"dmcrypt": {}, "uuid": "1886358c-4aa6-4f5d-9622-e1008d75f85d", "ptype": "45b0969e-9b03-4f30-b4c6-b4b80ceff106", "is_partition": True, "path": "/dev/sdb4", "type": "journal"}, {"dmcrypt": {}, "uuid": "37b3211b-03e8-43de-be71-25269f889bc3", "ptype": "30cd0809-c2b2-499c-8879-2d6b78529876", "is_partition": True, "path": "/dev/sdb5", "type": "block.db"}, {"dmcrypt": {}, "uuid": "605a3682-8ae6-4e5a-9da0-81b0f0ddec7b", "ptype": "5ce17fce-4087-4169-b7ff-056cc58473f9", "is_partition": True, "path": "/dev/sdb6", "type": "block.wal"}]}, {"path": "/dev/sdc", "type": "other", "dmcrypt": {}, "ptype": "unknown", "is_partition": False}, {"path": "/dev/sdd", "partitions": [{"block_dev": "/dev/sdd2", "block_uuid": "59b2200d-7d85-47d6-ad37-4919619b1e35", "dmcrypt": {}, "uuid": "fedb12a4-59e2-41ee-8c4b-fa563f899c73", "mount": "/var/lib/ceph/tmp/mnt.vxqI3F", "ptype": "4fbd7e29-9d25-41b8-afd0-062c0ceff05d", "is_partition": True, "cluster": "", "state": "active", "fs_type": "xfs", "ceph_fsid": "a4a33288-6aa9-443d-a1aa-aa0fa655a057", "path": "/dev/sdd1", "type": "data", "whoami": ""}, {"dmcrypt": {}, "uuid": "59b2200d-7d85-47d6-ad37-4919619b1e35", "ptype": "cafecafe-9b03-4f30-b4c6-b4b80ceff106", "is_partition": True, "path": "/dev/sdd2", "block_for": "/dev/sdd1", "type": "block"}]}, {"dmcrypt": {}, "ptype": "unknown", "is_partition": False, "fs_type": "LVM2_member", "path": "/dev/sde", "type": "other"}, {"path": "/dev/sdf", "partitions": [{"dmcrypt": {}, "uuid": "", "ptype": "0xc", "is_partition": True, "fs_type": "vfat", "path": "/dev/sdf1", "type": "other"}]}]  # noqa E501


def is_read_only_device(physical_disk):
    devices = {"loop0": False, "sda": False, "sdb": False,
               "sdc": False, "sdd": False, "sde": False, "sdf": True}
    if physical_disk in devices:
        return devices[physical_disk]
    else:
        exit("unexpected {} in is_read_only_device()".format(physical_disk))


def get_ceph_volume_lvm_list(partition, container_image=None):
    partitions = {}
    empty_answers = ["loop0", "sda1", "sda2", "sda3", "sda4", "sda5", "sdb1", "sdb2", "sdb3", "sdb4", "sdb5", "sdb6", "sdc", "sdd1", "sdd2"]  # noqa 501
    partitions["/dev/sde"] = {
        "3": [
            {
                "lv_name": "osd-block-5cfacdf7-999e-4b1d-b599-515b2a02faa9",
                "lv_path": "/dev/ceph-a4a33288-6aa9-443d-a1aa-aa0fa655a057/osd-block-5cfacdf7-999e-4b1d-b599-515b2a02faa9",  # noqa 501
                "lv_tags": "ceph.block_device=/dev/ceph-a4a33288-6aa9-443d-a1aa-aa0fa655a057/osd-block-5cfacdf7-999e-4b1d-b599-515b2a02faa9,ceph.block_uuid=FdQUPI-xvp2-1tAc-ubIO-DGAf-yfAT-FAO24e,ceph.cephx_lockbox_secret=,ceph.cluster_fsid=a4a33288-6aa9-443d-a1aa-aa0fa655a057,ceph.cluster_name=ceph,ceph.crush_device_class=None,ceph.encrypted=0,ceph.osd_fsid=5cfacdf7-999e-4b1d-b599-515b2a02faa9,ceph.osd_id=3,ceph.type=block",  # noqa 501
                "lv_uuid": "FdQUPI-xvp2-1tAc-ubIO-DGAf-yfAT-FAO24e",
                "name": "osd-block-5cfacdf7-999e-4b1d-b599-515b2a02faa9",
                "path": "/dev/ceph-a4a33288-6aa9-443d-a1aa-aa0fa655a057/osd-block-5cfacdf7-999e-4b1d-b599-515b2a02faa9",  # noqa 501
                "tags": {
                    "ceph.block_device": "/dev/ceph-a4a33288-6aa9-443d-a1aa-aa0fa655a057/osd-block-5cfacdf7-999e-4b1d-b599-515b2a02faa9",  # noqa 501
                    "ceph.block_uuid": "FdQUPI-xvp2-1tAc-ubIO-DGAf-yfAT-FAO24e",
                    "ceph.cephx_lockbox_secret": "",
                    "ceph.cluster_fsid": "a4a33288-6aa9-443d-a1aa-aa0fa655a057",
                    "ceph.cluster_name": "ceph",
                    "ceph.crush_device_class": "None",
                    "ceph.encrypted": "0",
                    "ceph.osd_fsid": "5cfacdf7-999e-4b1d-b599-515b2a02faa9",
                    "ceph.osd_id": "3",
                    "ceph.type": "block"
                },
                "type": "block",
                "vg_name": "ceph-a4a33288-6aa9-443d-a1aa-aa0fa655a057"
            }
        ]
    }

    for empty_answer in empty_answers:
        partitions["/dev/{}".format(empty_answer)] = {}

    if partition in partitions:
        return partitions[partition]
    else:
        exit("unexpected {} in get_ceph_volume_lvm_list()".format(partition))


def is_invalid_partition_table(partition):
    partitions = {}
    partitions["/dev/loop0"] = "/dev/loop0:10,7GB:loopback:512:512:gpt:Loopback device:;"
    partitions["/dev/sda1"] = "Error: /dev/sda1: unrecognised disk label"
    partitions["/dev/sda4"] = "Error: Can't have a partition outside the disk!"
    unrecognised_partitions = ["sda1", "sdb1", "sdb2",
                               "sdb3", "sdb4", "sdb5", "sdb6", "sdc", "sdd2"]
    unknown_partitions = ["sda2", "sda3", "sda5"]

    for unknown_partition in unknown_partitions:
        partitions["/dev/{}".format(unknown_partition)] = "/dev/sda2:1074MB:unknown:512:512:loop:Unknown:;"  # noqa 501

    for unrecognised_partition in unrecognised_partitions:
        partitions["/dev/{}".format(unrecognised_partition)] = "Error: /dev/{}: unrecognised disk label".format(partition)  # noqa 501

    if partition in partitions:
        if 'unrecognised disk label' not in partitions[partition].lower():
            if "error:" in partitions[partition].lower():
                return "failed"

        return ""
    else:
        exit("unexpected {} in is_valid_partition_table()".format(partition))


def get_partition_label(partition):
    partitions = {}
    empty_answers = ["loop0", "sda1", "sda2", "sda3", "sda4", "sda5", "sdc"]
    journals = ["sdb1", "sdb2", "sdb3", "sdb4"]
    for journal in journals:
        partitions["/dev/{}".format(journal)] = "ceph journal"

    partitions["/dev/sdd2"] = "ceph block"
    partitions["/dev/sdb5"] = "ceph block.db"
    partitions["/dev/sdb6"] = "ceph block.wal"
    for empty_answer in empty_answers:
        partitions["/dev/{}".format(empty_answer)] = ""
    if partition in partitions:
        return partitions[partition]
    else:
        exit("unexpected {} in get_partition_label()".format(partition))


def is_lvm_disk(physical_disk):
    physical_disks = {}
    physical_disks["loop0"] = False
    physical_disks["sdc"] = False
    if physical_disk in physical_disks:
        return physical_disks[physical_disk]
    else:
        exit("unexpected {} in is_lvm_disk()".format(physical_disk))


def is_locked_raw_device(physical_disk):
    physical_disks = {}
    physical_disks["loop0"] = True
    physical_disks["sdc"] = False
    if physical_disk in physical_disks:
        return physical_disks[physical_disk]
    else:
        exit("unexpected {} in is_locked_raw_device()".format(physical_disk))
